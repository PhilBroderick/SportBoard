@model List<SportBoard.Data.DAL.UserNotification>
@{
    ViewBag.Title = "Index";
}

<h2>Inbox</h2>
<div class="col-md-12">
    <div id="notificationfilterOptions" class="col-md-12">
        <ul class="nav nav-tabs" id="filterOptions">
            <li role="presentation" class="All active"><a href="#">All</a></li>
            <li role="presentation" class="Posts"><a href="#">Posts</a></li>
            <li role="presentation" class="Comments"><a href="#">Comments</a></li>
            <li role="presentation" class="DeletionRequests"><a href="#">Deletion Requests</a></li>
            <li role="presentation" class="DeletionResponses"><a href="#">Deletion Responses</a></li>
        </ul>
    </div>
    <div class="col-md-3">
        <label><input type="checkbox" id="viewRead"/>View read notifications</label>
    </div>
</div>

<div class="col-md-12">
    <div class="notificationView">
        @Html.Partial("UserNotifications", Model)
    </div>
</div>

@section Scripts {

    <script>
        $(document).ready(function () {
            $('#filterOptions li').on("click", function () {
                var onlyUnread = isOnlyUnread();
                removeActive();

                $(this).toggleClass('active');
                var selection = $(this).text();
                var linkUrl = '/UserNotification/FilterNotifications?filterOption=' + selection + "&onlyUnread=" + onlyUnread;

                $.ajax({
                    url: linkUrl,
                    type: "GET",
                    dataType: "html",
                    success: function (data) {
                        $('.notificationView').html(data);
                    }
                });
            });

            $('#viewRead').change(function () {
                var onlyUnread = isOnlyUnread();
                var selection = activeFilterOption();
                var linkUrl = '/UserNotification/FilterNotifications?filterOption=' + selection + "&onlyUnread=" + onlyUnread;

                $.ajax({
                    url: linkUrl,
                    type: "GET",
                    dataType: "html",
                    success: function (data) {
                        $('.notificationView').html(data);
                    }
                });
            });

            function removeActive() {
                var kids = $('#filterOptions').find('li');
                kids.removeClass('active');
            }

            var isOnlyUnread = function () {
                var onlyUnread = true;
                if ($('#viewRead').prop("checked")) {
                    onlyUnread = false;
                }
                return onlyUnread;
            }

            var activeFilterOption = function () {
                return $('.active').text();
            }
            

            @*$('#viewRead').change(function () {
                var viewReadUrl = '@Url.Action("ViewReadNotifications", "UserNotification")';
                if (this.checked) {
                    $.ajax({
                        url: viewReadUrl,
                        type: "GET",
                        dataType: "html",
                        success: function (data) {
                            $('.notificationView').html(data);
                        }
                    })
                }
            })*@
        });
    </script>
}